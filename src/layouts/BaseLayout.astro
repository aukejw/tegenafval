---
export interface Props {
    title: string;
}

const { title } = Astro.props;
---

<!DOCTYPE html>
<html lang="nl">
    <head>
        <!-- `sizes="any"` is to fix Chrome bug -->
        <link rel="icon" href="/favicons/favicon.ico" sizes="any" />
        <link rel="icon" href="/favicons/icon.svg" type="image/svg+xml" />
        <link rel="apple-touch-icon" href="/favicons/apple-touch-icon.png" />
        <link rel="manifest" href="/favicons/manifest.webmanifest" />

        <meta charset="utf-8" />
        <title>{title}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/style.css" />
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // Dark mode toggle functionality
                const darkModeToggle = document.getElementById('dark-mode-toggle');
                const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
                
                // Check for saved theme preference or default to system preference
                const currentTheme = localStorage.getItem('theme');
                if (currentTheme === 'dark' || (!currentTheme && prefersDarkScheme.matches)) {
                    document.body.classList.add('dark-mode');
                    if (darkModeToggle) {
                        darkModeToggle.textContent = '‚òÄÔ∏è';
                    }
                } else {
                    document.body.classList.remove('dark-mode');
                    if (darkModeToggle) {
                        darkModeToggle.textContent = 'üåô';
                    }
                }

                // Toggle dark mode
                if (darkModeToggle) {
                    darkModeToggle.addEventListener('click', function() {
                        document.body.classList.toggle('dark-mode');
                        const isDark = document.body.classList.contains('dark-mode');
                        localStorage.setItem('theme', isDark ? 'dark' : 'light');
                        darkModeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
                    });
                }

                // Language toggle functionality
                const languageToggle = document.getElementById('language-toggle');
                let currentLang = localStorage.getItem('language') || 'nl';
                updateLanguage(currentLang);
                
                if (languageToggle) {
                    languageToggle.addEventListener('click', function() {
                        currentLang = currentLang === 'nl' ? 'en' : 'nl';
                        localStorage.setItem('language', currentLang);
                        updateLanguage(currentLang);
                        
                        // Navigate to the corresponding page in the new language
                        const currentPath = window.location.pathname;
                        let newPath;
                        
                        if (currentLang === 'en') {
                            if (currentPath === '/' || currentPath === '/nl/home') {
                                newPath = '/en/home';
                            } else if (currentPath === '/probleem' || currentPath === '/nl/probleem') {
                                newPath = '/en/probleem';
                            } else if (currentPath === '/oplossingen' || currentPath === '/nl/oplossingen') {
                                newPath = '/en/oplossingen';
                            } else if (currentPath === '/gemeente' || currentPath === '/nl/gemeente') {
                                newPath = '/en/gemeente';
                            } else {
                                newPath = '/en/home'; 
                            }
                        } else {
                            if (currentPath === '/en/home') {
                                newPath = '/';
                            } else if (currentPath === '/en/probleem') {
                                newPath = '/probleem';
                            } else if (currentPath === '/en/oplossingen') {
                                newPath = '/oplossingen';
                            } else if (currentPath === '/en/gemeente') {
                                newPath = '/gemeente';
                            } else {
                                newPath = '/'; 
                            }
                        }
                        
                        window.location.href = newPath;
                    });
                }

                function updateLanguage(lang) {
                    const navLinks = document.querySelectorAll('.main-nav a');
                    const languageToggle = document.getElementById('language-toggle');
                    
                    if (lang === 'en') {
                        // Update navigation links to English
                        navLinks[0].href = '/en/home';
                        navLinks[0].textContent = 'Home';
                        navLinks[1].href = '/en/probleem';
                        navLinks[1].textContent = 'The problem';
                        navLinks[2].href = '/en/oplossingen';
                        navLinks[2].textContent = 'How can I help?';
                        navLinks[3].href = '/en/gemeente';
                        navLinks[3].textContent = 'What about the municipality?';
                        
                        if (languageToggle) {
                            languageToggle.textContent = 'NL';
                        }
                    } else {
                        // Update navigation links to Dutch
                        navLinks[0].href = '/';
                        navLinks[0].textContent = 'Home';
                        navLinks[1].href = '/probleem';
                        navLinks[1].textContent = 'Het probleem';
                        navLinks[2].href = '/oplossingen';
                        navLinks[2].textContent = 'Wat kan ik zelf doen?';
                        navLinks[3].href = '/gemeente';
                        navLinks[3].textContent = 'Wat doet de gemeente?';
                        
                        if (languageToggle) {
                            languageToggle.textContent = 'EN';
                        }
                    }
                }
            });
        </script>
    </head>
    <body>
        <main>
            <div class="content-container">
                <slot />
            </div>
        </main>
        <nav class="main-nav">
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/probleem">Het probleem</a></li>
                <li><a href="/oplossingen">Wat kan ik zelf doen?</a></li>
                <li><a href="/gemeente">Wat doet de gemeente?</a></li>
            </ul>
            <div class="nav-buttons">
                <button id="language-toggle" class="language-toggle">EN</button>
                <button id="dark-mode-toggle" class="dark-mode-toggle">üåô</button>
            </div>
        </nav>
    </body>
</html> 